<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<ModulePrefs title="-" />
<Content type="html"><![CDATA[

<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/netclassroom/z4a4m4446@main/TemplateData/style.css">





</head>
<body class="dark">
    <div id="unity-container" class="unity-desktop">
        <canvas id="unity-canvas"></canvas>
    </div>
    <div id="loading-cover" style="display:none;">
        <div id="unity-loading-bar">
            <div id="unity-progress-bar-empty" style="display: none;">
                <div id="unity-progress-bar-full"></div>
            </div>
            <div class="spinner"></div>
        </div>
    </div>

    <!-- Additional body modules -->





    <script>
    const hideFullScreenButton = "";
    const buildUrl = "https://cdn.jsdelivr.net/gh/netclassroom/z4a4m4446@main/Build";
    const loaderUrl = buildUrl + "/build.loader.js";
    const config = {
        dataUrl: buildUrl + "/build.data.unityweb",
        frameworkUrl: buildUrl + "/build.framework.js.unityweb",
        codeUrl: buildUrl + "/build.wasm.unityweb",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "Pocket Snake",
        productName: "Money Roller",
        productVersion: "0.1",
    };

    const container = document.querySelector("#unity-container");
    const canvas = document.querySelector("#unity-canvas");
    const loadingCover = document.querySelector("#loading-cover");
    const progressBarEmpty = document.querySelector("#unity-progress-bar-empty");
    const progressBarFull = document.querySelector("#unity-progress-bar-full");
    const spinner = document.querySelector('.spinner');

    const canFullscreen = (function () {
        for (const key of [
            'exitFullscreen',
            'webkitExitFullscreen',
            'webkitCancelFullScreen',
            'mozCancelFullScreen',
            'msExitFullscreen',
        ]) {
            if (key in document) {
                return true;
            }
        }
        return false;
    }());

    if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
        container.className = "unity-mobile";
        
    }

    
    canvas.style.background = "url('https://cdn.jsdelivr.net/gh/netclassroom/z4a4m4446@main/background.png') center / cover";

    loadingCover.style.display = "";

    canvas.addEventListener("touchstart", () => { window.focus() });
    canvas.addEventListener("pointerdown", () => { window.focus() });

    let player;
    let leaderboard;
    let myGameInstance = null;
    let payments = null;
    let promptCanShow = false;
    let reviewCanShow = false;
    let initSDK = false;
    let initGame = false;
    let photoSizeForInit;
    let scopesForInit;
    let firstAd = true;
    let nowFullAdOpen = false;

    const script = document.createElement("script");
    script.src = loaderUrl;
    script.onload = () => {
        createUnityInstance(canvas, config, (progress) => {
            spinner.style.display = "none";
            progressBarEmpty.style.display = "";
            progressBarFull.style.width = `${100 * progress}%`;
        }).then((unityInstance) => {
            myGameInstance = unityInstance;
            loadingCover.style.display = "none";
        }).catch((message) => {
            alert(message);
        });
    };

    function InitSDK(photoSize, scopes) {
        console.log('Init GAME');
        initGame = true;
       
    }

    function NotAuthorized() {
        try {
            console.log('Authorized failed');
            let authJson = {
                "playerAuth": "rejected",
                "playerName": "unauthorized",
                "playerId": "unauthorized",
                "playerPhoto": "null"
            };
            myGameInstance.SendMessage('YandexGame', 'SetInitializationSDK', JSON.stringify(authJson));
        } catch (e) {
            console.error('CRASH Not Authorized: ', e.message);
        }
    }

    function InitPlayer(photoSize, _scopes) {
        try {
            return ysdk.getPlayer({scopes: _scopes}).then(_player => {

                player = _player;

                let playerName = player.getName();
                let playerPhoto = player.getPhoto(photoSize);

                if (!_scopes) {
                    playerName = "anonymous";
                    playerPhoto = "null";
                }

                if (player.getMode() === 'lite') {

                    console.log('Not Authorized');
                    NotAuthorized();
                } else {
                    let authJson = {
                        "playerAuth": "resolved",
                        "playerName": playerName,
                        "playerId": player.getUniqueID(),
                        "playerPhoto": playerPhoto
                    };
                    myGameInstance.SendMessage('YandexGame', 'SetInitializationSDK', JSON.stringify(authJson));
                    window.focus();
                }
            }).catch(e => {
                console.error('Authorized err: ', e.message);
                NotAuthorized();
            });
        } catch (e) {
            console.error('CRASH init Player: ', e.message);
            window.focus();
        }
    }

    function OpenAuthDialog(photoSize, scopes) {
        try {
            ysdk.auth.openAuthDialog().then(() => {
                InitPlayer(photoSize, scopes);
            }).catch(() => {
                InitSDK(photoSize, scopes);
            });
        } catch (e) {
            console.log('CRASH Open Auth Dialog: ', e.message);
        }
    }

    function FullAdShow() {
       return;
    }

    function RewardedShow(id) {
       
                            console.log('Reward Video Ad. Id: ' + id);
                            myGameInstance.SendMessage('YandexGame', 'RewardVideo', id);
                     return;
    }

    function StickyAdActivity(show) {
       return;
    }

    function InitPayments() {
        try {
            ysdk.getPayments().then(_payments => {
                console.log('Purchases are available');
                payments = _payments;
            }).catch(e => {
                console.log('Purchases are not available', e.message);
            })
        } catch (e) {
            console.error('CRASH Init Payments: ', e.message);
        }
    }

    function BuyPayments(id) {
        try {
            if (payments != null) {
                payments.purchase(id).then(() => {
                    console.log('Purchase Success');
                    ConsumePurchase(id);
                    window.focus();
                }).catch(e => {
                    console.error('Purchase Failed', e.message);
                    myGameInstance.SendMessage('YandexGame', 'OnPurchaseFailed', id);
                    window.focus();
                })
            } else {
                console.log('Payments == null');
            }
        } catch (e) {
            console.error('CRASH Buy Payments: ', e.message);
            window.focus();
        }
    }

    function GetPayments() {
        try {
            if (payments != null) {
                payments.getCatalog()
                    .then(products => {
                        let productID = [];
                        let title = [];
                        let description = [];
                        let imageURI = [];
                        let priceValue = [];
                        let consumed = [];

                        payments.getPurchases().then(purchases => {
                            for (let i = 0; i < products.length; i++) {
                                productID[i] = products[i].id;
                                title[i] = products[i].title;
                                description[i] = products[i].description;
                                imageURI[i] = products[i].imageURI;
                                priceValue[i] = products[i].priceValue;

                                consumed[i] = true;
                                for (i2 = 0; i2 < purchases.length; i2++) {
                                    if (purchases[i2].productID === productID[i]) {
                                        consumed[i] = false;
                                        break;
                                    }
                                }
                            }

                            let jsonPayments = {
                                "id": productID,
                                "title": title,
                                "description": description,
                                "imageURI": imageURI,
                                "priceValue": priceValue,
                                "consumed": consumed
                            };

                            myGameInstance.SendMessage('YandexGame', 'PaymentsEntries', JSON.stringify(jsonPayments));
                        });
                    });
            }
            else{
                console.log('Get Payments: payments == null');
            }
        } catch (e) {
            console.error('CRASH Get Payments: ', e.message);
        }
    }

    function ConsumePurchase(id) {
        try {
            if (payments != null) {
                payments.getPurchases().then(purchases => {
                    for(i = 0; i < purchases.length; i++){
                        if (purchases[i].productID === id) {
                            payments.consumePurchase(purchases[i].purchaseToken);
                            myGameInstance.SendMessage('YandexGame', 'OnPurchaseSuccess', id);
                        }
                    }
                });
            }
            else console.log('Consume purchase: payments null');
        } catch (e) {
            console.error('CRASH Consume Purchase: ', e.message);
        }
    }

    function ConsumePurchases() {
        try {
            if (payments != null) {
                payments.getPurchases().then(purchases => {
                    console.log('Unprocessed purchases: ', purchases.length);
                    for(i = 0; i < purchases.length; i++){
                        payments.consumePurchase(purchases[i].purchaseToken);
                        myGameInstance.SendMessage('YandexGame', 'OnPurchaseSuccess', purchases[i].productID);
                    }
                });
            }
            else console.log('Consume purchases: payments null');
        } catch (e) {
            console.error('CRASH Consume purchases: ', e.message);
        }
    }

    function SaveCloud(jsonData, flush) {
        try {
            player.setData({
                saves: [jsonData],
            }, flush);
        } catch (e) {
            console.error('CRASH Save Cloud: ', e.message);
        }
    }

    function LoadCloud() {
        try {
            player.getData(["saves"]).then(data => {
                if (data.saves) {
                    myGameInstance.SendMessage('YandexGame', 'SetLoadSaves', JSON.stringify(data.saves));
                } else {
                    myGameInstance.SendMessage('YandexGame', 'SetLoadSaves', "noData");
                }
            }).catch(() => {
                console.error('getData Error!');
                myGameInstance.SendMessage('YandexGame', 'SetLoadSaves', "noData");
            });
        } catch (e) {
            console.error('CRASH Load saves Cloud: ', e.message);
            myGameInstance.SendMessage('YandexGame', 'SetLoadSaves', "noData");
        }
    }

    function InitLeaderboard() {
        try {
            ysdk.getLeaderboards().then(_lb => {
                leaderboard = _lb
                myGameInstance.SendMessage('YandexGame', 'InitializedLB');
            });
        } catch (e) {
            console.error('CRASH Init Leaderboard: ', e.message);
        }
    }

    function SetLeaderboardScores(_name, score) {
        try {
            ysdk.getLeaderboards()
                .then(leaderboard => {
                    leaderboard.setLeaderboardScore(_name, score);
                });
        } catch (e) {
            console.error('CRASH Set Leader board Scores: ', e.message);
        }
    }

    function GetLeaderboardScores(nameLB, maxPlayers, quantityTop, quantityAround, photoSize, auth) {
        try {
            var jsonEntries = {
                technoName: '',
                isDefault: false,
                isInvertSortOrder: false,
                decimalOffset: 0,
                type: '' // , title: ''
            };

            ysdk.getLeaderboards()
                .then(leaderboard => leaderboard.getLeaderboardDescription(nameLB))
                .then(res => {
                    jsonEntries.technoName = nameLB;
                    jsonEntries.isDefault = res.default;
                    jsonEntries.isInvertSortOrder = res.description.invert_sort_order;
                    jsonEntries.decimalOffset = res.description.score_format.options.decimal_offset;
                    jsonEntries.type = res.description.type; // Не определяется на момент 18.07.23
                    //jsonEntries.title = res.title; // Реализуйте по предпочтениям

                    return leaderboard.getLeaderboardEntries(nameLB, {
                        quantityTop: quantityTop,
                        includeUser: auth,
                        quantityAround: quantityAround
                    });
                })
                .then(res => {
                    let jsonPlayers = EntriesLB(res, maxPlayers, photoSize);
                    let combinedJson = { ...jsonEntries, ...jsonPlayers };

                    myGameInstance.SendMessage('YandexGame', 'LeaderboardEntries', JSON.stringify(combinedJson));
                })
                .catch(error => {
                    console.error(error);
                });
        }
        catch (e) {
            console.error('CRASH Get Leaderboard: ', e.message);
        }
    }

    function EntriesLB(res, maxPlayers, photoSize) {
        let LeaderboardEntriesText = '';
        let playersCount;

        if (res.entries.length < maxPlayers) {
            playersCount = res.entries.length;
        } else {
            playersCount = maxPlayers;
        }

        let ranks = new Array(playersCount);
        let photos = new Array(playersCount);
        let mames = new Array(playersCount);
        let scores = new Array(playersCount);
        let uniqueIDs = new Array(playersCount);

        for (i = 0; i < playersCount; i++) {
            ranks[i] = res.entries[i].rank;
            scores[i] = res.entries[i].score;
            uniqueIDs[i] = res.entries[i].player.uniqueID;

            if (photoSize === 'nonePhoto' || res.entries[i].player.scopePermissions.avatar !== "allow") {
                photos[i] = 'nonePhoto';
            } else {
                photos[i] = res.entries[i].player.getAvatarSrc(photoSize);
            }

            if (res.entries[i].player.scopePermissions.public_name !== "allow") {
                mames[i] = "anonymous";
            } else {
                mames[i] = res.entries[i].player.publicName;
            }

            LeaderboardEntriesText += ranks[i] + '. ' + mames[i] + ": " + scores[i] + '\n';
        }

        if (playersCount === 0) {
            LeaderboardEntriesText = 'no data';
        }

        let jsonPlayers = {
            "entries": LeaderboardEntriesText,
            "ranks": ranks,
            "photos": photos,
            "names": mames,
            "scores": scores,
            "uniqueIDs": uniqueIDs
        };

        return jsonPlayers;
    }

function LanguageRequest() {
    try {
        // ysdk.environment.i18n.lang yerine direkt 'en' gönderiyoruz
        myGameInstance.SendMessage('YandexGame', 'SetLanguage', 'en');
    } catch (e) {
        console.error('CRASH Language Request: ', e.message);
    }
}

function RequestingEnvironmentData() {
    try {
        let jsonEnvir = {
            "language": "en", // Zorla İngilizce yaptık
            "domain": ysdk.environment.i18n.tld,
            "deviceType": ysdk.deviceInfo.type,
            "isMobile": ysdk.deviceInfo.isMobile(),
            "isDesktop": ysdk.deviceInfo.isDesktop(),
            "isTablet": ysdk.deviceInfo.isTablet(),
            "isTV": ysdk.deviceInfo.isTV(),
            "appID": ysdk.environment.app.id,
            "browserLang": "en", // Tarayıcı dilini de İngilizce olarak maskeledik
            "payload": ysdk.environment.payload,
            "promptCanShow": promptCanShow,
            "reviewCanShow": reviewCanShow
        };
        myGameInstance.SendMessage('YandexGame', 'SetEnvironmentData', JSON.stringify(jsonEnvir));
    } catch (e) {
        console.error('CRASH Requesting Environment Data: ', e.message);
    }
}

    function Review() {
        return;
    }

    function PromptShow() {
        return;
    }

    function PaintRBT(rbt) {
        try {
            document.getElementById(rbt).style.background = '#ff0000';
        } catch (e) {
            console.error('CRASH Paint RBT: ', e.message);
        }
    }

    function StaticRBTDeactivate() {
    }

    // Additional script modules:

    document.body.appendChild(script);
    </script>

    <style>
  #ad-container {
    position: fixed;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: min(728px, calc(100% - 20px));
    height: 90px;
    background: rgba(0, 0, 0, 0.90);
    display: none;
    z-index: 99999;
    overflow: hidden;
    box-shadow: 0 -2px 12px rgba(0, 0, 0, 0.45);
    transition: transform 0.5s ease-in-out;
  }

  #ad-container.hidden { transform: translate(-50%, 100%); }

  #ad-iframe {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 745px;
    height: 90px;
    border: 0;
  }

  /* Close button: Initial Top Center */
  #close-ad {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%) scale(0.9);
    transform-origin: center;
    background: #ff4d4d;
    color: #fff;
    border: none;
    padding: 5px 10px;
    font-size: 11px;
    font-weight: bold;
    border-radius: 4px;
    cursor: not-allowed;
    opacity: 0.9;
    z-index: 100000;
    white-space: nowrap;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }

  /* Corner State Styling */
  #close-ad.enabled {
    cursor: pointer;
    opacity: 1;
    background: #ff1a1a;
    box-shadow: 0 0 15px #ff4d4d, 0 0 30px #ff4d4d;
    animation: glow-pulse 1.5s infinite alternate;
  }

  @keyframes glow-pulse {
    from { box-shadow: 0 0 5px #ff4d4d, 0 0 10px #ff4d4d; }
    to { box-shadow: 0 0 20px #ff4d4d, 0 0 35px #ff4d4d; opacity: 0.8; }
  }

  #close-ad::before {
    content: '✕';
    margin-right: 2px;
  }

  @media (max-width: 440px) {
    #ad-container { width: calc(100% - 12px); }
    #ad-iframe { width: 728px; }
  }
</style>

<div id="ad-container" aria-hidden="true">
  <iframe id="ad-iframe" src="https://script.google.com/macros/s/AKfycbzNG4z_PlG6Ke_bX5wSPKK2uBRB3IY9ouVzqM1shucYhSTvsJWRmyMyZaaC2z5S3ADN/exec" scrolling="no" frameborder="0" sandbox="allow-scripts allow-popups allow-same-origin"></iframe>
  <button id="close-ad" disabled>Wait (12)</button>
</div>

<script>
  (function () {
    const showDelay = 2000; 
    const countdownStart = 12; 
    const reappearDelay = 150000; // 2.5 MINUTES (150 seconds)
    const adContainer = document.getElementById('ad-container');
    const closeBtn = document.getElementById('close-ad');

    function setRandomCorner() {
      const corners = [
        { top: '2px', left: '2px', right: 'auto', bottom: 'auto', transform: 'scale(0.5)' },    // Top-Left
        { top: '2px', left: 'auto', right: '2px', bottom: 'auto', transform: 'scale(0.5)' },   // Top-Right
        { top: 'auto', left: '2px', right: 'auto', bottom: '2px', transform: 'scale(0.5)' },   // Bottom-Left
        { top: 'auto', left: 'auto', right: '2px', bottom: '2px', transform: 'scale(0.5)' }    // Bottom-Right
      ];
      
      const randomChoice = corners[Math.floor(Math.random() * corners.length)];
      Object.assign(closeBtn.style, randomChoice);
    }

    function resetToCenter() {
      closeBtn.style.top = '0';
      closeBtn.style.left = '50%';
      closeBtn.style.right = 'auto';
      closeBtn.style.bottom = 'auto';
      closeBtn.style.transform = 'translateX(-50%) scale(0.9)';
    }

    function showAd() {
      resetToCenter();
      adContainer.style.display = 'block';
      adContainer.classList.remove('hidden');
      
      let timeLeft = countdownStart;
      closeBtn.disabled = true;
      closeBtn.classList.remove('enabled');
      closeBtn.textContent = `Wait (${timeLeft})`;

      const t = setInterval(() => {
        timeLeft--;
        if (timeLeft > 0) {
          closeBtn.textContent = `Wait (${timeLeft})`;
        } else {
          clearInterval(t);
          closeBtn.disabled = false;
          closeBtn.textContent = ''; 
          setRandomCorner(); 
          closeBtn.classList.add('enabled'); 
        }
      }, 1000);
    }

    setTimeout(showAd, showDelay);

    closeBtn.addEventListener('click', () => {
      if (closeBtn.disabled) return;
      adContainer.classList.add('hidden');
      // Set to reappear after 150 seconds
      setTimeout(showAd, reappearDelay);
    });
  })();
</script>

</body>
</html>





]]></Content>
</Module>